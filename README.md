# Arduino 反射神経ゲーム 説明書

## 概要

このプログラムは、複数のLEDとボタンを使用した反射神経ゲームです。ランダムに点灯するLEDに対応するボタンを押すことで得点を獲得します。ゲーム時間は30秒で、正解時のみブザーが鳴ります。

## 使用ピン

| 役割      | ピン                                     |
| ------- | -------------------------------------- |
| 入力ボタン   | 36, 39, 34, 35, 32, 33, 25, 26, 27, 14 |
| 出力LED   | 22, 1, 3, 21, 17, 16, 4, 0, 2, 15      |
| スタートボタン | 36, 39                                 |
| ブザー     | 23                                     |

## 定数・変数

```cpp
int targetIndex = -1;           // 現在のターゲットLEDインデックス
bool gameRunning = false;       // ゲーム進行フラグ
unsigned long ledOnTime = 0;    // LED点灯時間計測
const unsigned long ledDuration = 500;  // LED点灯時間（500ms）
const unsigned long gameDuration = 30000; // ゲーム時間（30秒）
unsigned long gameStartTime = 0; // ゲーム開始時刻
int score = 0;                  // 得点
bool lastButtonState[pinCount] = {0}; // ボタン立ち上がり判定用
```

## setup() の処理

* LED出力ピンを初期化
* 入力ボタンピンを設定（内部プルアップの有無をピンに応じて設定）
* ブザーピンを初期化
* 待機アニメーションを表示

## loop() の処理

1. ゲームが開始していない場合、スタートボタンを待機
2. ゲーム中は以下を繰り返す

   * ゲーム終了判定（30秒経過で終了）
   * ボタン押下チェック（立ち上がりのみ検出）

     * 正解なら得点 + ブザー鳴動 + 次のターゲットLED表示
     * 間違いなら次のターゲットLED表示
   * タイムアウト判定（LED点灯時間を超えた場合）

## 関数

### waitForStart()

* スタートボタンを押すとゲーム開始
* 全LED点滅で開始演出
* ゲームフラグをtrueにして、得点を0にリセット

### nextRound()

* 現在のLEDを消灯
* ランダムに次のターゲットLEDを点灯
* LED点灯時間をリセット

### blinkAllLEDs(times, interval)

* 全LEDを指定回数点滅
* intervalで点滅間隔を指定

### showWaitingAnimation()

* 待機中に順番にLEDを点灯するループアニメーション

### showScore()

* ゲーム終了時、得点分だけブザーで点滅表示
* 2000Hzの音を150ms鳴らし、短い間隔で繰り返す
